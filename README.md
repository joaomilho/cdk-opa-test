# Testing opa + CDK (ts)

The goal of using opa with CDK is to have a way to define constraints on the infrastructure generated. For instance one can limit how many instances are created, or prohibit instances to allow ssh access, or literally everything you can think of.

This repo follows the [Realize policy as code with AWS Cloud Development Kit through Open Policy Agent](https://aws.amazon.com/blogs/opensource/realize-policy-as-code-with-aws-cloud-development-kit-through-open-policy-agent/) article, but with TS.

The cloudformation generated by this CDK stack has an EC2 instance with open SSH access, so when running you'll the the rule `deny_ssh_enabled` defined in [opa_cdk.rego](./opa_cdk.rego) will fail.

Running:

```sh
yarn synth
yarn opa
```